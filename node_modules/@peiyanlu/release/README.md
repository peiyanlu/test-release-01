# Release Project

<p>
  <a href="https://www.npmjs.com/package/@peiyanlu/create-release" target="_blank">
    <img src="https://img.shields.io/badge/npm-@peiyanlu/create--release-blue.svg?logo=npm" alt="NPM Package" />
  </a>
  <a href="https://www.npmjs.com/package/@peiyanlu/create-release" target="_blank">
    <img src="https://img.shields.io/npm/v/@peiyanlu/create-release.svg" alt="NPM Version" />
  </a>
  <a href="https://www.npmjs.com/package/@peiyanlu/create-release" target="_blank">
    <img src="https://img.shields.io/npm/l/@peiyanlu/create-release.svg" alt="Package License" />
  </a>
  <a href="https://www.npmjs.com/package/@peiyanlu/create-release" target="_blank">
    <img src="https://img.shields.io/npm/dm/@peiyanlu/create-release.svg" alt="NPM Downloads" />
  </a>
</p>


ğŸš€ Generic CLI tool to automate versioning and package publishing

- Bump version (in e.g. `package.json`)
- [Git commit, tag, push][1]
- [Create release at GitHub][3]
- [Generate changelog][5]
- [Publish to npm][6]

## Installation

```bash
npm install -D @peiyanlu/release

yarn add -D @peiyanlu/release

pnpm add -D @peiyanlu/release
```

## Configuration

å‘å¸ƒæµç¨‹å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œè‡ªå®šä¹‰ã€‚å¦‚æœé¡¹ç›®ä¸­æ²¡æœ‰æä¾›é…ç½®æ–‡ä»¶ï¼Œå·¥å…·ä¼šè‡ªåŠ¨ä½¿ç”¨å†…ç½®çš„é»˜è®¤é…ç½®ï¼Œé…ç½®æ–‡ä»¶å¯ä»¥æ˜¯ä»¥ä¸‹æ–‡ä»¶ä¹‹ä¸€ï¼š`release.config.{ts,mts,cts,js,mjs,cjs}`

```ts
// release.config.ts
import { defineConfig } from '@peiyanlu/release'


export default defineConfig({
  git: {
    commitMessage: 'chore(release): ${version}',
    tagName: '${version}',
  },
  npm: {
    publish: true,
  },
  github: {
    release: true,
    autoGenerate: true,
  },
})

```

## Git


å°† **æš‚å­˜ï¼ˆstageï¼‰â†’ æäº¤ï¼ˆcommitï¼‰â†’ æ‰“æ ‡ç­¾ï¼ˆtagï¼‰â†’ æ¨é€ï¼ˆpushï¼‰** è¿™äº›å‘å¸ƒæ­¥éª¤è‡ªåŠ¨åŒ–ï¼Œå¹¶æ”¯æŒæ¨é€åˆ° **ä»»æ„ Git è¿œç¨‹ä»“åº“**ã€‚


## npmjs.com Releases


æˆªè‡³ **2025 å¹´ 7 æœˆ**ï¼ŒGitHub CI å·¥ä½œæµç°åœ¨å¯ä»¥ä½¿ç”¨ npm çš„ **[Trusted Publishingï¼ˆå¯ä¿¡å‘å¸ƒï¼‰][30]** çš„ **OpenID Connectï¼ˆOIDCï¼‰** é›†æˆï¼Œä» CI/CD ä¸­å®ç°**å®‰å…¨ã€æ—  Token çš„å‘å¸ƒ**ã€‚
è¿™å°†ä¸å†éœ€è¦é•¿æœŸæœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œï¼ˆlong-lived tokensï¼‰ï¼Œå¹¶ä¸”ä¼š**è‡ªåŠ¨ç”Ÿæˆæ¥æºè¯æ˜ï¼ˆprovenance attestationsï¼‰**ã€‚


## GitHub Releases

GitHub é¡¹ç›®å¯ä»¥å°† **Release** é™„åŠ åˆ° **Git æ ‡ç­¾ï¼ˆTagï¼‰** ä¸Šï¼Œå…¶ä¸­åŒ…å« **å‘å¸ƒè¯´æ˜ï¼ˆrelease notesï¼‰** å’Œ **æ„å»ºäº§ç‰©ï¼ˆassetsï¼‰**ã€‚
åœ¨ä½ çš„å‘å¸ƒæµç¨‹ä¸­ï¼Œæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥åˆ›å»º **GitHub Releases**ï¼š

1. **è‡ªåŠ¨åŒ–æ–¹å¼**ï¼ˆéœ€è¦æä¾› `GITHUB_TOKEN`ï¼‰
2. **æ‰‹åŠ¨æ–¹å¼**ï¼ˆé€šè¿‡ GitHub ç½‘é¡µç•Œé¢ï¼Œä½¿ç”¨é¢„å…ˆå¡«å……å¥½çš„å­—æ®µæ¥åˆ›å»ºï¼‰

## Changelog

é€šè¿‡è¯»å– Git æäº¤å†å²ï¼ˆ`git log`ï¼‰ è‡ªåŠ¨ç”Ÿæˆ Changelog

```bash
git log --pretty=format:"%s %h %H" {from}...{to}
```

## Publish to npm

é€šè¿‡è¯»å– `package.json` ä¸­çš„ `publishConfig` é…ç½®å‘å¸ƒåˆ° npm ä»“åº“


## Dry Runs

ä½¿ç”¨ `--dry-run` å¯ä»¥å±•ç¤ºæ•´ä¸ªäº¤äº’æµç¨‹ï¼Œä»¥åŠå·¥å…·åŸæœ¬å°†è¦æ‰§è¡Œçš„æ‰€æœ‰å‘½ä»¤ï¼Œä½†ä¸ä¼šçœŸæ­£æ‰§è¡Œä»»ä½•æ“ä½œã€‚


[1]: #git

[3]: #github-releases

[5]: #changelog

[6]: #publish-to-npm

[30]: https://docs.npmjs.com/trusted-publishers

[32]: https://docs.github.com/en/repositories/releasing-projects-on-github/about-releases
